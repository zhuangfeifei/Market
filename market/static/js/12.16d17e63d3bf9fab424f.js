webpackJsonp([12],{"1alW":function(t,e,s){var o=s("kM2E");o(o.S,"Number",{isInteger:s("AKgy")})},AKgy:function(t,e,s){var o=s("EqjI"),n=Math.floor;t.exports=function(t){return!o(t)&&isFinite(t)&&n(t)===t}},"B+7s":function(t,e){},GnXF:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("RRo+"),n=s.n(o),i=(s("fxnj"),{data:function(){return{value:"",showKeyboard:!0,isYu:!0,PageShow:!0}},components:{},props:["isWx","moeny","redMoneys"],beforeCreate:function(){},created:function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.document.title="支付订单"},computed:{orderDetail:function(){return this.$store.state.orderDetail},user:function(){return""==this.$store.state.user&&this.$store.commit("USER"),this.$store.state.user}},methods:{isShowPay:function(){this.$store.commit("SET_PAY",!1)},pay:function(){this.isWx?this.wxPay():this.isYu=!1},onInput:function(t){if(this.value=(this.value+t).slice(0,6),6==this.value.length)if(this.$store.commit("SET_PAY",!1),!this.isWx&&this.user.wtCustomer.amount>this.moeny){this.$store.commit("isLoading",!1),this.$toast.loading({mask:!0,message:"支付中...",duration:0});var e={access_type:"WXH5",wxh:this.$store.state.market_wxh,openId:this.$store.state.market_openId,unionId:this.$store.state.market_unionId,orderIds:this.orderDetail.ID,payType:3,payPwd:this.value,totalMoney:this.moeny,couponMoney:this.redMoneys.price,couponId:this.redMoneys.couponId,yueAmount:0,wxAmount:0};this.$store.dispatch("PayCommon",e)}else this.wxPay()},onDelete:function(){this.value=this.value.slice(0,this.value.length-1)},wxPay:function(){this.$store.commit("SET_PAY",!1),"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",this.onBridgeReady,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",this.onBridgeReady),document.attachEvent("onWeixinJSBridgeReady",this.onBridgeReady)):this.onBridgeReady()},onBridgeReady:function(){var t={access_type:"WXH5",wxh:this.$store.state.market_wxh,openId:this.$store.state.market_openId,unionId:this.$store.state.market_unionId,orderIds:this.orderDetail.ID,payType:2,totalMoney:this.moeny,couponMoney:this.redMoneys.price,couponId:this.redMoneys.couponId,yueAmount:0,wxAmount:0},e={access_type:"WXH5",wxh:this.$store.state.market_wxh,openId:this.$store.state.market_openId,unionId:this.$store.state.market_unionId,orderId:this.orderDetail.ID,payType:4,payPwd:this.value,totalMoney:this.moeny,couponMoney:this.redMoneys.price,couponId:this.redMoneys.couponId,yueAmount:this.user.wtCustomer.amount,wxAmount:parseFloat((this.moeny-this.user.wtCustomer.amount).toFixed(2))};this.isWx?this.$store.dispatch("PayCommon",t):this.$store.dispatch("PayCommon",e)}}}),r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"PayCommon"}},[o("van-popup",{attrs:{position:"bottom",overlay:!0,"close-on-click-overlay":!1},model:{value:t.PageShow,callback:function(e){t.PageShow=e},expression:"PageShow"}},[o("van-row",{staticClass:"Pay_title"},[o("van-col",{attrs:{span:"3"}},[o("img",{attrs:{src:s("Pldz"),alt:""},on:{click:t.isShowPay}})]),t._v(" "),o("van-col",{attrs:{span:"18"}},[t._v("确认付款")])],1),t._v(" "),t.isYu?o("div",{staticClass:"Pay_change"},[o("p",[t._v("订单编号："+t._s(t.orderDetail.ORDER_NO))]),t._v(" "),o("h4",[t._v("¥"+t._s(t.isWx?t.moeny:t.user.wtCustomer.amount>t.moeny?t.moeny:(t.moeny-t.user.wtCustomer.amount).toFixed(2)))]),t._v(" "),o("div",{staticClass:"Pay_start",on:{click:t.pay}},[t._v("立即付款")])]):o("div",{staticClass:"Pay_passwod"},[o("p",[t._v("请输入余额支付密码")]),t._v(" "),o("van-password-input",{staticClass:"Pay_input",attrs:{value:t.value,info:""},on:{focus:function(e){t.showKeyboard=!0}}}),t._v(" "),o("van-number-keyboard",{attrs:{show:t.showKeyboard},on:{input:t.onInput,delete:t.onDelete,blur:function(e){t.showKeyboard=!0}}})],1)],1)],1)},staticRenderFns:[]};var a=s("VU/8")(i,r,!1,function(t){s("B+7s")},"data-v-51805d23",null).exports,d=(s("NYxO"),{data:function(){return{chosenCoupon:-1,showList:!1,imgs:[s("jeJ6"),s("rTzp")],isChecked:!1,redMoneys:{couponId:"",price:0},yueAmount:0,wxAmount:0}},components:{"PayCommon-item":a},beforeCreate:function(){this.$store.dispatch("orderDetail",this.$route.query.orderId),this.$store.dispatch("user"),this.$store.dispatch("mySelfRedPacketListPay")},computed:{orderDetail:function(){return this.wxAmount=this.$store.state.orderDetail.ORDER_MONEY,this.$store.state.orderDetail},coupons:function(){return this.$store.getters.coupons},user:function(){return this.$store.state.user},isAmountFloats:function(){if(this.user)return n()(this.user.wtCustomer.amount)?this.user.wtCustomer.amount+".00":this.user.wtCustomer.amount},moeny:function(){return this.orderDetail.ORDER_MONEY-this.redMoneys.price<0?0:(this.orderDetail.ORDER_MONEY-this.redMoneys.price).toFixed(2)},isPays:function(){return this.$store.state.isPay}},created:function(){var t=this;document.body.scrollTop=0,document.documentElement.scrollTop=0,document.title="订单确认",this.$nextTick(function(){t.yueAmount=0,t.wxAmount=t.orderDetail.ORDER_MONEY})},activated:function(){},methods:{address:function(){this.$router.push("/Address")},isChangeChecked:function(){this.isAmountFloats>0&&(this.isChecked=!this.isChecked,this.isChecked?(this.yueAmount=this.isAmountFloats>this.orderDetail.ORDER_MONEY?this.orderDetail.ORDER_MONEY:this.isAmountFloats,this.wxAmount=this.isAmountFloats>this.orderDetail.ORDER_MONEY?0:this.orderDetail.ORDER_MONEY-this.isAmountFloats):(this.yueAmount=0,this.wxAmount=this.orderDetail.ORDER_MONEY))},onChange:function(t){var e=this;if(this.showList=!1,this.chosenCoupon=t,t>-1){var s={couponId:this.coupons[t].couponId,orderMoney:this.orderDetail.ORDER_MONEY,goodsId:null};this.$store.dispatch("validationRedPacket",s).then(function(t){200==t.data.code?(e.redMoneys.couponId=t.data.data.couponId,e.redMoneys.price=t.data.data.price):e.$toast(t.data.message)}).catch(function(t){})}else this.redMoneys.price=0},isPay:function(){var t=this;this.isChecked||""!=this.user.wtCustomer.payPassword&&null!=this.user.wtCustomer.payPassword?this.$store.commit("SET_PAY",!0):this.$dialog.confirm({title:"您还没有设置密码！",confirmButtonText:"去设置"}).then(function(){t.$router.push({path:"/Setpassword"})}).catch(function(){})}}}),u={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"OrdersSubmitted"}},[o("div",{staticClass:"OrdersSubmitted_order"},[o("h4",[t._v("订单信息")]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_"},[o("div",{staticClass:"OrdersSubmitted_order_content"},[o("p",[t._v("订单编号")]),o("span",[t._v(t._s(t.orderDetail.ORDER_NO))])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_content"},[o("p",[t._v("下单时间")]),o("span",[t._v(t._s(t.orderDetail.ORDER_DATE))])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_content"},[o("p",[t._v("订单金额")]),o("span",[t._v(t._s(t.orderDetail.ORDER_MONEY)+"元")])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_content"},[o("p",[t._v("账户余额（"+t._s(t.isAmountFloats||0)+"元）")]),t._v(" "),o("p",[o("img",{staticClass:"OrdersSubmitted_order_checked",attrs:{src:t.isAmountFloats>0&&t.isChecked?t.imgs[1]:t.imgs[0],alt:""},on:{click:t.isChangeChecked}}),o("span",[t._v(t._s(t.isAmountFloats>0?"可用":"不可用"))])])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_content",on:{click:function(e){t.showList=!0}}},[o("p",[t._v("优惠红包")]),o("p",[o("span",{staticClass:"redMoney"},[t._v(t._s(t.redMoneys.price)+"元")]),o("img",{staticClass:"OrdersSubmitted_order_more",attrs:{src:s("nX5x"),alt:""}})]),t._v(" "),o("van-coupon-cell",{staticClass:"OrdersSubmitted_red",attrs:{coupons:t.coupons,"chosen-coupon":t.chosenCoupon},on:{click:function(e){t.onWatchshowList=!0}}})],1)]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_Real"},[o("span",[t._v("余额实付")]),o("span",[t._v(t._s(0==t.wxAmount?t.yueAmount>t.redMoneys.price?t.yueAmount-t.redMoneys.price:0:t.redMoneys.price>t.wxAmount?t.yueAmount-(t.redMoneys.price-t.wxAmount):t.yueAmount)+"元")])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_order_Real"},[o("span",[t._v("微信实付")]),o("span",[t._v(t._s(t.wxAmount>t.redMoneys.price?t.wxAmount-t.redMoneys.price:0)+"元")])])]),t._v(" "),o("div",{staticClass:"OrdersSubmitted_footer"},[o("div",[o("small",[t._v("¥")]),o("span",[t._v(t._s(t.moeny))]),o("span",[t._v("（优惠"+t._s(t.redMoneys.price)+"元）")])]),t._v(" "),o("div",{on:{click:t.isPay}},[t._v("订单付款")])]),t._v(" "),t.isPays?o("PayCommon-item",{attrs:{isWx:!t.isChecked,moeny:t.moeny,redMoneys:t.redMoneys}}):t._e(),t._v(" "),o("van-popup",{attrs:{position:"bottom"},model:{value:t.showList,callback:function(e){t.showList=e},expression:"showList"}},[o("van-coupon-list",{attrs:{coupons:t.coupons,"chosen-coupon":t.chosenCoupon,"show-exchange-bar":!1},on:{change:t.onChange}})],1)],1)},staticRenderFns:[]};var c=s("VU/8")(d,u,!1,function(t){s("bVKv")},"data-v-79f0f1b5",null);e.default=c.exports},"RRo+":function(t,e,s){t.exports={default:s("c45H"),__esModule:!0}},bVKv:function(t,e){},c45H:function(t,e,s){s("1alW"),t.exports=s("FeBl").Number.isInteger}});
//# sourceMappingURL=12.16d17e63d3bf9fab424f.js.map